### 谈谈对微服务的理解

1. 微服务很小，以业务边界确定系统边界，每个服务专注于做好一件事情。
2. 微服务具有自治性，服务之间通过暴露API实现网络通信，服务高度内聚可单独部署，互不影响。

### 微服务的好处

1. 技术的异构性：根据服务需求选择合适的技术实现。
2. 提升效率：小型代码在小型团队更为高效，接口约束后，可以并行开发。
3. 弹性：微服务中如果一个服务不可用了，不会导致整个应用都不可用。
4. 易扩容：可以只对需要扩容的服务进行扩容，降低成本。
5. 可组合性：可以根据不同的目的，通过不同的方式使用同一个功能。
6. 简化部署：各服务的部署时独立的，当部分代码发生变更后，只需要重新部署对应的服务。
7. 降低风险：重写或者移除小规模服务阻碍很小。

### 微服务架构的不足

- 运维要求较高
  - 对于单体架构来讲，只需要维护好这一个项目就可以了。但是对于微服务架构来讲，由于项目是由多个微服务构成的，每个模块出现问题都会造成整个项目运行出现异常，这就对运维人员提出了很高的要求。
- 分布式的复杂性
  - 对于微服务架构来说，分布式是必需的技术，由于分布式的复杂性，导致微服务架构也变得复杂起来。

- 接口调整成本高
  - 微服务的接口发生大的变动时，所有依赖它的微服务可能都要做相应的调整，由于微服务可能非常多，那么调整接口所造成的成本将会明显提高。

- 重复劳动
  - 对于单体架构来讲，如果某段业务被多个模块所共同使用，我们可以抽象成一个工具类，被所有模块直接调用。但是微服务的工具类是不能被其它微服务所直接调用的，从而我们便不得不在每个微服务上都建这么一个工具类，从而导致代码的重复。

### HTTP调用和RPC调用的比较

在HTTP和RPC的选择上，有些人是迷惑的。有些RPC框架配置复杂，用HTTP也能完成同样的功能，为什么要选择RPC，而不是更容易上手的HTTP来实现了。

**比较一下：**

- 传输协议 
  - RPC：可以基于TCP协议，也可以基于HTTP协议。
  - HTTP：基于HTTP协议。

- 传输效率
  - RPC：使用自定义的TCP协议，可以让请求报文体积更小，或者使用HTTP2协议，也可以很好的减少报文的体积，提高传输效率。
  - HTTP：如果是基于HTTP1.1的协议，请求中会包含很多无用的内容，如果是基于HTTP2.0，那么简单的封装以下是可以作为一个RPC来使用的，这时标准RPC框架更多的是服务治理。
- 性能消耗（主要在于序列化和反序列化的耗时）
  - RPC：可以基于thrift实现高效的二进制传输
  - HTTP：大部分是通过json来实现的，字节大小和序列化耗时都比thrift要更消耗性能

RPC主要用于公司内部的服务调用，性能消耗低，传输效率高，服务治理方便。HTTP主要用于对外的异构环境，浏览器接口调用，APP接口调用，第三方接口调用等。

### 微服务部署策略

微服务应用程序由数十甚至上百个服务组成。服务以不同的语言和框架编写。每个都是一个迷你的应用程序，具有自己特定的部署、资源、扩展和监视要求。需要根据该服务的需求运行每个服务的一定数量的实例。此外，必须为每个服务实例提供相应的 CPU、内存和 I/O 资源。



### 参考资料

《微服务设计》

